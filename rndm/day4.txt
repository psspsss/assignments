https://github.com/psspsss/wipro-devops-repo/blob/0dde87c7c03a22168422b443e2cc5d66e3f3a5ab/k8s/deployment.yml


https://raw.githubusercontent.com/psspsss/wipro-devops-repo/refs/heads/main/k8s/deployment.yml


kubectl apply -f https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml

kubectl get pods -n kube-system | findstr metrics

kubectl get pods -n kube-system | findstr metrics
 


@echo off setlocal REM Source and destination paths set SRC=C:\ProgramData\Jenkins\.jenkins\workspace\New Job set DEST=C:\Users\Administrator\Downloads\nginx-1.28.1\html echo Cleaning destination folder... if exist "%DEST%" ( del /q "%DEST%\** for /d %%d in ("%DEST%\*") do rmdir /s /q "%%d" ) echo Copying files from Jenkins workspace to Nginx html... хсору "%SRC%\*" "%DEST%\" /E/I/Y echo Deployment completed successfully. endlocal


node {

    def mvnHome
 
    stage('Preparation') {

        // Checkout the correct branch from GitHub

        git branch: 'main',

            url: 'https://github.com/diptendramaity/jenkins_apps'

    }

}
 






node {

    stage('Stage 1: Checkout Code from Git') {

        // Clone Space Science repository into Jenkins workspace
        git branch: 'main', url: 'https://github.com/harsh3109/Space-Science.git'

    }

    stage('Stage 2: Copy Files to NGINX html Folder') {

        bat '''
        echo Copying files from Jenkins workspace to NGINX html folder...

        xcopy "%WORKSPACE%\\*" "C:\\Users\\Administrator\\Downloads\\nginx-1.29.4\\html\\" /E /I

        echo Files copied successfully.
        '''

    }
}



write a manifest file to deploy 3 replica of the docker image on Kubernetes image is on docker repo it should be stateful with volume



# Headless Service (required for StatefulSet)
apiVersion: v1
kind: Service
metadata:
  name: app-headless
spec:
  clusterIP: None
  selector:
    app: stateful-app
  ports:
    - port: 80
---
# StatefulSet with 3 replicas and persistent volume
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: stateful-app
spec:
  serviceName: app-headless
  replicas: 3
  selector:
    matchLabels:
      app: stateful-app
  template:
    metadata:
      labels:
        app: stateful-app
    spec:
      containers:
        - name: app-container
          image: nginx:latest   # replace with your Docker repo image
          ports:
            - containerPort: 80
          volumeMounts:
            - name: data-volume
              mountPath: /data
  volumeClaimTemplates:
    - metadata:
        name: data-volume
      spec:
        accessModes:
          - ReadWriteOnce
        resources:
          requests:
            storage: 1Gi
